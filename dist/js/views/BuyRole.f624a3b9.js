import{_ as a}from"../HeaderTitle/HeaderTitle.41d7b1f9.js";import{i as s}from"../img24/img24.ed6b89f9.js";import{u as t,a as e}from"../vue-router/vue-router.6a5eb8ba.js";import{u as o}from"../vuex/vuex.adf06551.js";import{p as l,s as r,a as i,t as c,c as n,u,e as v,g as p}from"../starcraft-sdk/starcraft-sdk.b9fffec7.js";import{k as h,c as m,r as w,e as b,A as f,j as y,M as g,u as j,N as d,x as T,O as k,F as $,B as S,g as x,C,Q as L,R as B}from"../@vue/@vue.f0ed93ab.js";import{_ as P}from"../vue-count-to/vue-count-to.7851cffd.js";import"../img32/img32.2d4b9acf.js";import"../starcraft-core/starcraft-core.a7e8a7b2.js";import"../@ethersproject/@ethersproject.82fce948.js";import"../bn.js/bn.js.022a57fe.js";import"../aes-js/aes-js.52245d71.js";import"../hash.js/hash.js.951de082.js";import"../minimalistic-assert/minimalistic-assert.62310433.js";import"../inherits/inherits.e883a70c.js";import"../bech32/bech32.0c6cc0e9.js";import"../js-sha3/js-sha3.ce966f76.js";import"../ethers/ethers.7357afd8.js";import"../@apollo/@apollo.167459d8.js";import"../tslib/tslib.cdb03bbf.js";import"../optimism/optimism.dbbdffb5.js";import"../@wry/@wry.ac881673.js";import"../ts-invariant/ts-invariant.73996d61.js";import"../graphql/graphql.c449efb6.js";import"../zen-observable-ts/zen-observable-ts.11549e90.js";import"../symbol-observable/symbol-observable.efed2817.js";import"../graphql-tag/graphql-tag.47c56ce3.js";const A=""+new URL("../../png/img28.c3b71fe8.png",import.meta.url).href,U=a=>(L("data-v-508ffcf1"),a=a(),B(),a),_={class:"container"},F={class:"container2"},I=["src"],O={class:"tabs_content"},E={class:"tabs"},q=["src"],N=["src"],z=U((()=>g("div",{class:"des"},[T(" In the first 5000 lucky boxes,you have chance toget the high-level planet. After 5000 lucky boxes,you can get a 1st-level planet in a lucky box. "),g("br"),g("br"),T(" You only can have one planet for one address. ")],-1))),M=U((()=>g("div",{class:"des"},[T(" In the first 20000 lucky boxes,you have chance toget the level-2 planet."),g("br"),g("br"),T(" You only can have one planet for one address. ")],-1))),R=P(h({__name:"BuyRole",setup(h){const{proxy:L}=x(),B=o(),P=t(),U=e(),R=m((()=>B.state.walletAccount)),H=w(0),X=w(1),Y=w(0),D=w(0),Q=w(0),V=w(0),G=w(0),J=w(!0),K=w(0),W=w(!0);b((()=>{la(),ra(),Z(U.params.type),R.value&&(aa(),sa(),ta())}));const Z=a=>{X.value=a},aa=async()=>{L.$showLoadingToast({});try{const a=await l().userSCPId(R.value);if(Number(a)>0)H.value=2;else{if((await r().tokensOfOwnerBySize(R.value,0,1e3))[0].length>0)H.value=2;else{const a=await i().isDrawed(R.value);H.value=a?1:0}}L.$closeToast()}catch(a){L.$showFailToast("Error")}},sa=async()=>{G.value=await L.$walletUtils.getBalance(c().SCT),J.value=await L.$walletUtils.checkApprove(c().SCT,n().SCPBox,G.value)},ta=async()=>{K.value=await L.$walletUtils.getBalance(c().L3),W.value=await L.$walletUtils.checkApprove(c().L3,n().SCPBox,K.value)},ea=async()=>{L.$showLoadingToast({});try{const a=await v(c().SCT).connect(p()).approve(n().SCPBox,u.parseUnits(1e10.toString()));await a.wait(),sa(),L.$showSuccessToast()}catch(a){L.$closeToast()}},oa=async()=>{L.$showLoadingToast({});try{const a=await v(c().L3).connect(p()).approve(n().SCPBox,u.parseUnits(1e10.toString()));await a.wait(),ta(),L.$showSuccessToast()}catch(a){L.$closeToast()}},la=()=>{i().boxPrice(0).then((a=>{Q.value=L.$utils.utilFormat(u.formatEther(a))})).catch((a=>{L.$showFailToast("Error")})),i().boxPrice(1).then((a=>{V.value=L.$utils.utilFormat(u.formatEther(a))})).catch((a=>{L.$showFailToast("Error")}))},ra=()=>{i().getBoxLeftSupply(0).then((a=>{Y.value=Number(a)})).catch((a=>{})),i().getBoxLeftSupply(1).then((a=>{D.value=Number(a)})).catch((a=>{}))},ia=async()=>{if(!R.value)return L.$showToast("Please connect wallet");if(Q.value>G.value)return L.$showToast("Insufficient balance");if(Y.value&&!(H.value>0)){L.$showLoadingToast({});try{const a=await i().connect(p()).draw(0);await a.wait(),L.$showSuccessToast(),setTimeout((()=>{P.push("/Mining")}),1e3)}catch(a){L.$closeToast()}}},ca=async()=>{if(!R.value)return L.$showToast("Please connect wallet");if(V.value>K.value)return L.$showToast("Insufficient balance");if(D.value&&!(H.value>0)){L.$showLoadingToast({});try{const a=await i().connect(p()).draw(1);await a.wait(),L.$showSuccessToast(),setTimeout((()=>{P.push("/Mining")}),1e3)}catch(a){L.$closeToast()}}};return(t,e)=>{const o=a;return C(),f("section",_,[y(o,{headTitle:"Planet Lucky Box"}),g("div",F,[g("img",{class:"box",src:j(A),alt:""},null,8,I),g("div",O,[g("div",E,[g("div",{class:d({active:1==X.value}),onClick:e[0]||(e[0]=a=>Z(1))},[T(" Advanced Planet "),2==X.value?(C(),f("img",{key:0,class:"img1",src:j(s),alt:""},null,8,q)):k("",!0)],2),g("div",null,[1==X.value?(C(),f("img",{key:0,class:"img2",src:j(s),alt:""},null,8,N)):k("",!0)])]),1==X.value?(C(),f($,{key:0},[J.value?(C(),f("button",{key:0,class:"btn",onClick:ia},S(Q.value)+" SCT for 1 Planet Lucky BOX",1)):(C(),f("button",{key:1,class:"btn",onClick:ea},"Approve SCT")),z],64)):k("",!0),2==X.value?(C(),f($,{key:1},[W.value?(C(),f("button",{key:0,class:"btn",onClick:ca},S(V.value)+" L3 for 1 Planet Lucky BOX",1)):(C(),f("button",{key:1,class:"btn",onClick:oa},"Approve L3")),M],64)):k("",!0)])])])}}}),[["__scopeId","data-v-508ffcf1"]]);export{R as default};
