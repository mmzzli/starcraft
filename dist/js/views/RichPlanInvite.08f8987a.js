import{_ as a}from"../HeaderTitle/HeaderTitle.41d7b1f9.js";import{k as s,c as t,r as e,e as i,A as r,j as o,M as l,u as n,B as c,s as u,S as v,N as m,g as p,C as d,Q as h,R as j}from"../@vue/@vue.f0ed93ab.js";import{i as b}from"../img24/img24.ed6b89f9.js";import{a as f}from"../vue-router/vue-router.6a5eb8ba.js";import{u as g}from"../vuex/vuex.adf06551.js";import{r as w,u as T,t as y,e as S,g as $}from"../starcraft-sdk/starcraft-sdk.b9fffec7.js";import{C as U}from"../index/index.b777d8e2.js";import{r as _}from"../config/config.dfdc56f9.js";import{i as C}from"../inviting/inviting.00ec2d8c.js";import{_ as k}from"../lodash/lodash.207f849d.js";import{_ as x}from"../vue-count-to/vue-count-to.7851cffd.js";import"../img32/img32.2d4b9acf.js";import"../starcraft-core/starcraft-core.a7e8a7b2.js";import"../@ethersproject/@ethersproject.82fce948.js";import"../bn.js/bn.js.022a57fe.js";import"../aes-js/aes-js.52245d71.js";import"../hash.js/hash.js.951de082.js";import"../minimalistic-assert/minimalistic-assert.62310433.js";import"../inherits/inherits.e883a70c.js";import"../bech32/bech32.0c6cc0e9.js";import"../js-sha3/js-sha3.ce966f76.js";import"../ethers/ethers.7357afd8.js";import"../@apollo/@apollo.167459d8.js";import"../tslib/tslib.cdb03bbf.js";import"../optimism/optimism.dbbdffb5.js";import"../@wry/@wry.ac881673.js";import"../ts-invariant/ts-invariant.73996d61.js";import"../graphql/graphql.c449efb6.js";import"../zen-observable-ts/zen-observable-ts.11549e90.js";import"../symbol-observable/symbol-observable.efed2817.js";import"../graphql-tag/graphql-tag.47c56ce3.js";const I=""+new URL("../../png/img52.80a53cc9.png",import.meta.url).href,q=a=>(h("data-v-6a079f7b"),a=a(),j(),a),A={class:"container"},D={class:"container2"},P=["src"],R={class:"from"},E={class:"tabs_content"},F={class:"tabs"},B=q((()=>l("div",{class:"active"}," Buy SCT ",-1))),L=["src"],z={class:"main_contaienr"},H={class:"input_wrap"},N=q((()=>l("div",{class:"input_token"},"USDT",-1))),O={class:"ava_balance"},Q=q((()=>l("div",{class:"tips_content"}," *Tip: The price is the actual exchange rate and the final price is subject to actual receipt. ",-1))),V=["disabled"],M=["disabled"],W=x(s({__name:"RichPlanInvite",setup(s){const{proxy:h}=p(),j=g(),x=f(),q=t((()=>j.state.walletAccount)),W=t((()=>j.state.inviteCode)),Y=e(""),G=e(null),J=e(0),K=e(0),X=e(!1),Z=e(null),aa=e(!1);i((()=>{x.query.inviteCode&&j.commit("setInviteCode",x.query.inviteCode),Y.value=W.value,q.value&&(ra(),ea())}));const sa=k.debounce((async()=>{G.value?ta():J.value=0}),500),ta=async()=>{try{const a=U(_,w,C),s=await a.getAmountsOut(T.parseUnits(G.value.toString()),[y().USDT,y().SCT]);return J.value=h.$utils.utilFormat(T.formatEther(s[1])),K.value=s[1],K.value}catch(a){h.$showFailToast("Error")}},ea=async()=>{try{const a=U(_,w,C);"0x0000000000000000000000000000000000000000"!==(await a.userInviter(q.value)).inviter&&(aa.value=!0)}catch(a){h.$showFailToast("Error")}},ia=async()=>{G.value?(ra(),sa()):J.value=0},ra=async()=>{Z.value=await h.$walletUtils.getBalance(y().USDT);const a=null===G.value?0:G.value;X.value=await h.$walletUtils.checkApprove(y().USDT,_,a)},oa=async()=>{h.$showLoadingToast({});try{const a=await S(y().USDT).connect($()).approve(_,T.parseUnits(1e10.toString()));await a.wait(),ra(),h.$showSuccessToast()}catch(a){h.$closeToast()}},la=async()=>{if(!q.value)return h.$showToast("Please connect wallet");if(G.value>Z.value)return h.$showToast("Insufficient balance");if(Y.value===q.value)return h.$showToast("inviter cannot be yourself");if(aa.value)return h.$showToast("Already invited");h.$showLoadingToast({});try{const a=U(_,w,C),s=await ta(),t=await a.connect($()).bindInviter(Y.value,T.parseUnits(G.value.toString()),s);await t.wait(),h.$showSuccessToast()}catch(a){h.$closeToast()}};return(s,t)=>{const e=a;return d(),r("section",A,[o(e,{headTitle:"Rich Plan"}),l("div",D,[l("img",{class:"banner",src:n(I),alt:""},null,8,P),l("p",R,"From: "+c(Y.value),1),l("div",E,[l("div",F,[B,l("div",null,[l("img",{class:"img2",src:n(b),alt:""},null,8,L)])]),l("div",z,[l("div",H,[u(l("input",{class:"input",type:"number","onUpdate:modelValue":t[0]||(t[0]=a=>G.value=a),placeholder:"Please Enter",onInput:ia},null,544),[[v,G.value]]),N]),l("div",O," You can get: "+c(n(h).$utils.formatNumber(J.value,4))+" SCT ",1),Q,X.value?(d(),r("button",{key:0,class:m(["button",{disabled:!G.value}]),disabled:!G.value,onClick:la},"Purchase",10,V)):(d(),r("button",{key:1,class:m(["button",{disabled:!G.value}]),disabled:!G.value,onClick:oa},"Approve USDT",10,M))])])])])}}}),[["__scopeId","data-v-6a079f7b"]]);export{W as default};
